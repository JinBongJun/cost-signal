# Cost Signal - 남은 작업 전체 정리

> **마지막 업데이트**: 2025-01-02  
> **현재 상태**: 테스트 단계 완료, 프로덕션 준비 필요

---

## ✅ 완료된 기능

### 핵심 기능
- ✅ 주간 경제 신호 계산 및 표시 (3단계: OK, CAUTION, RISK)
- ✅ 무료/유료 티어 구분 및 데이터 표시
- ✅ Preview 모드 (로그인 없이 유료 기능 미리보기)
- ✅ 경제 데이터 자동 수집 (EIA, BLS, FRED)
- ✅ Vercel Cron으로 매주 월요일 자동 업데이트
- ✅ Supabase 데이터베이스 연동

### 사용자 기능
- ✅ 인증 시스템 (NextAuth - 이메일/비밀번호)
- ✅ 회원가입/로그인 페이지
- ✅ 푸시 알림 (주간 자동 전송)
- ✅ PWA 지원 (앱 설치 가능)
- ✅ 히스토리 조회 (12주)
- ✅ 반응형 디자인 (모바일/데스크톱)

### UI/UX
- ✅ Toast 알림 시스템
- ✅ 로딩 스켈레톤 UI
- ✅ 에러 처리 및 사용자 친화적 메시지
- ✅ 재사용 가능한 컴포넌트 (Button, Card, SignalCard, HistorySection)
- ✅ 애니메이션 및 트랜지션
- ✅ SEO 메타데이터

### 결제 시스템 (코드 레벨)
- ✅ Paddle 결제 통합 (체크아웃 생성)
- ✅ Paddle 웹훅 처리 (구독 생성/업데이트/취소)
- ✅ 웹훅 서명 검증 (보안)
- ✅ 구독 상태 확인 (`hasActiveSubscription`)
- ✅ 결제 성공 페이지

---

## ⚠️ 부분적으로 완료된 기능

### 1. 푸시 알림
- ✅ Service Worker 생성 및 등록
- ✅ 푸시 구독 저장/삭제
- ✅ 주간 알림 자동 전송
- ⚠️ **Test Notification 버튼**: 개발 모드에서만 표시하도록 정리 필요

### 2. 결제 시스템
- ✅ 코드는 모두 구현됨
- ⚠️ **Paddle 설정 미완료**: 
  - API 키 설정 필요
  - Price ID 설정 필요
  - 웹훅 URL 설정 필요
  - `PADDLE_WEBHOOK_SECRET` 설정 필요
- ⚠️ **실제 결제 테스트**: 아직 안 함

---

## ❌ 아직 안 된 기능

### 1. 구독 관리 기능 (중요)
- ❌ 구독 관리 페이지 없음
- ❌ 구독 취소 기능 없음 (Paddle API는 있으나 UI 없음)
- ❌ 구독 상태 확인 페이지 없음
- ❌ 결제 내역 확인 불가
- ❌ 구독 갱신 알림 없음

### 2. 사용자 대시보드
- ❌ 사용자 프로필 페이지 없음
- ❌ 구독 정보 표시 페이지 없음
- ❌ 결제 내역 페이지 없음
- ❌ 알림 설정 페이지 없음

### 3. 에러 처리 및 모니터링
- ❌ 에러 로깅 시스템 없음 (Sentry 등)
- ❌ API 실패 시 재시도 로직 부족
- ❌ 데이터 수집 실패 시 알림 없음

### 4. 보안 및 최적화
- ❌ `/api/cron` 엔드포인트 인증 보호 없음 (현재 누구나 호출 가능)
- ❌ Rate limiting 없음
- ❌ API 키 로테이션 정책 없음

### 5. 문서화
- ❌ API 문서화 부족
- ❌ 배포 가이드 업데이트 필요
- ❌ 환경 변수 설명 문서 필요

---

## 🔧 프로덕션 준비를 위해 필요한 작업

### 1. Paddle 결제 설정 (필수)
- [ ] Paddle 계정 생성 및 설정
- [ ] Paddle API 키 발급
- [ ] Price ID 생성 (Monthly, Yearly, Early Bird)
- [ ] 웹훅 URL 설정: `https://your-domain.com/api/paddle/webhook`
- [ ] `PADDLE_WEBHOOK_SECRET` 설정
- [ ] 샌드박스에서 결제 테스트
- [ ] 프로덕션에서 결제 테스트

### 2. 구독 관리 기능 구현 (중요)
- [ ] `/account` 또는 `/dashboard` 페이지 생성
- [ ] 구독 정보 표시 (플랜, 상태, 만료일)
- [ ] 구독 취소 기능 (Paddle API 연동)
- [ ] 결제 내역 표시
- [ ] 구독 갱신 알림

### 3. 보안 강화 (중요)
- [ ] `/api/cron` 엔드포인트 인증 추가 (예: `CRON_SECRET` 헤더)
- [ ] Rate limiting 추가 (예: `@upstash/ratelimit`)
- [ ] CORS 설정 확인
- [ ] 환경 변수 검증 추가

### 4. 모니터링 및 로깅
- [ ] 에러 로깅 시스템 추가 (예: Sentry)
- [ ] API 호출 모니터링
- [ ] 데이터 수집 실패 알림 (이메일/Slack)
- [ ] 성능 모니터링

### 5. 테스트
- [ ] 단위 테스트 작성
- [ ] 통합 테스트 작성
- [ ] E2E 테스트 작성
- [ ] 프로덕션 환경 테스트

### 6. 문서화
- [ ] API 문서 작성 (Swagger/OpenAPI)
- [ ] 배포 가이드 업데이트
- [ ] 환경 변수 가이드 작성
- [ ] 트러블슈팅 가이드 작성

### 7. UI/UX 개선 (선택)
- [ ] 접근성 개선 (ARIA 레이블, 키보드 네비게이션)
- [ ] 다국어 지원 (i18n)
- [ ] 다크 모드 개선
- [ ] PWA 아이콘 PNG 변환 (현재 SVG)

---

## 📋 우선순위별 작업 목록

### 🔴 높은 우선순위 (프로덕션 필수)
1. **Paddle 결제 설정 및 테스트** (2-3시간)
   - Paddle 계정 설정
   - API 키 및 Price ID 설정
   - 웹훅 설정
   - 결제 테스트

2. **구독 관리 페이지 생성** (2-3시간)
   - `/account` 페이지
   - 구독 정보 표시
   - 구독 취소 기능

3. **보안 강화** (1-2시간)
   - `/api/cron` 인증 추가
   - Rate limiting 추가

### 🟡 중간 우선순위 (프로덕션 권장)
4. **에러 로깅 시스템** (1-2시간)
   - Sentry 또는 유사 서비스 통합

5. **Test Notification 버튼 정리** (5분)
   - 개발 모드에서만 표시

6. **문서화 개선** (1-2시간)
   - API 문서
   - 배포 가이드

### 🟢 낮은 우선순위 (선택)
7. **사용자 대시보드 확장** (2-3시간)
   - 프로필 페이지
   - 결제 내역
   - 알림 설정

8. **테스트 작성** (4-6시간)
   - 단위 테스트
   - 통합 테스트

9. **UI/UX 개선** (2-4시간)
   - 접근성
   - 다국어 지원

---

## 🚀 프로덕션 배포 체크리스트

### 환경 변수 설정
- [ ] `NEXT_PUBLIC_APP_URL` (프로덕션 도메인)
- [ ] `DATABASE_URL` (Supabase)
- [ ] `NEXTAUTH_SECRET`
- [ ] `NEXTAUTH_URL`
- [ ] `OPENAI_API_KEY`
- [ ] `EIA_API_KEY`
- [ ] `FRED_API_KEY`
- [ ] `BLS_API_KEY` (선택)
- [ ] `PADDLE_API_KEY`
- [ ] `PADDLE_WEBHOOK_SECRET`
- [ ] `PADDLE_PRICE_ID_MONTHLY`
- [ ] `PADDLE_PRICE_ID_YEARLY`
- [ ] `PADDLE_PRICE_ID_EARLY_BIRD`
- [ ] `VAPID_PUBLIC_KEY`
- [ ] `VAPID_PRIVATE_KEY`
- [ ] `VAPID_EMAIL`
- [ ] `CRON_SECRET` (선택, 보안 강화용)

### 기능 테스트
- [ ] 데이터 수집 테스트
- [ ] 신호 계산 테스트
- [ ] 푸시 알림 테스트
- [ ] 결제 플로우 테스트
- [ ] 웹훅 수신 테스트
- [ ] 구독 상태 업데이트 테스트

### 성능 테스트
- [ ] 페이지 로딩 속도
- [ ] API 응답 시간
- [ ] 데이터베이스 쿼리 최적화

### 보안 테스트
- [ ] 인증/인가 테스트
- [ ] SQL Injection 방지 확인
- [ ] XSS 방지 확인
- [ ] CSRF 방지 확인

---

## 📝 참고 사항

### 현재 테스트 단계
- 모든 기능이 코드 레벨에서 구현되어 있음
- 실제 결제는 아직 테스트 안 함
- Preview 모드로 유료 기능 확인 가능

### 나중에 실전할 때 정리할 것
- Paddle 설정 및 결제 테스트
- 구독 관리 기능 구현
- 보안 강화
- 모니터링 시스템 구축

### 유지보수
- 매주 월요일 자동 업데이트 확인
- API 키 만료 확인
- 데이터 수집 실패 모니터링
- 사용자 피드백 수집

---

## 🎯 다음 단계

1. **지금 할 것**: Test Notification 버튼 정리 (5분)
2. **나중에 할 것**: 프로덕션 준비 작업 (위 체크리스트 참고)

---

**마지막 업데이트**: 2025-01-02


